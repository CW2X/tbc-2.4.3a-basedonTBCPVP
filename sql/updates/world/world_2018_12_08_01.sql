
DROP TABLE IF EXISTS `quest_template_addon`;

CREATE TABLE `quest_template_addon` (
  `ID` mediumint(8) unsigned NOT NULL DEFAULT 0,
  `MaxLevel` tinyint(3) unsigned NOT NULL DEFAULT 0, 
  `AllowableClasses` int(10) unsigned NOT NULL DEFAULT 0, 
  `SourceSpellID` mediumint(8) unsigned NOT NULL DEFAULT 0, 
  `PrevQuestID` mediumint(8) NOT NULL DEFAULT 0, 
  `NextQuestID` mediumint(8) unsigned NOT NULL DEFAULT 0,
  `ExclusiveGroup` mediumint(8) NOT NULL DEFAULT 0, 
  `RewardMailTemplateID` mediumint(8) unsigned NOT NULL DEFAULT 0, 
  `RewardMailDelay` int(10) unsigned NOT NULL DEFAULT 0, 
  `RequiredSkillID` smallint(5) unsigned NOT NULL DEFAULT 0,
  `RequiredSkillPoints` smallint(5) unsigned NOT NULL DEFAULT 0,
  `RequiredMinRepFaction` smallint(5) unsigned NOT NULL DEFAULT 0,
  `RequiredMaxRepFaction` smallint(5) unsigned NOT NULL DEFAULT 0, 
  `RequiredMinRepValue` mediumint(8) NOT NULL DEFAULT 0, 
  `RequiredMaxRepValue` mediumint(8) NOT NULL DEFAULT 0, 
  `ProvidedItemCount` tinyint(3) unsigned NOT NULL DEFAULT 0, 
  `SpecialFlags` tinyint(3) unsigned NOT NULL DEFAULT 0,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO quest_template_addon
	SELECT entry, 0, IF( SkillorClass < 0, -SkillorClass, 0), SrcSpell, PrevQuestID, NextQuestInChain, ExclusiveGroup, RewMailTemplateId, RewMailDelaySecs, IF( SkillorClass > 0, SkillorClass, 0), RequiredSkillValue, RequiredMinRepFaction, RequiredMaxRepFaction, RequiredMinRepValue, RequiredMaxRepValue,SrcItemCount, SpecialFlags FROM quest_template;
	
ALTER TABLE quest_template DROP COLUMN SkillorClass, DROP COLUMN SrcSpell, DROP COLUMN PrevQuestId, DROP COLUMN ExclusiveGroup, DROP COLUMN NextQuestInChain, DROP COLUMN RewMailTemplateId, DROP COLUMN RewMailDelaySecs, DROP COLUMN RequiredSkillValue, DROP COLUMN RequiredMinRepFaction, DROP COLUMN RequiredMaxRepFaction, DROP COLUMN RequiredMinRepValue, DROP COLUMN RequiredMaxRepValue, DROP COLUMN SrcItemCount, DROP COLUMN SpecialFlags;

DROP TABLE IF EXISTS `game_event_seasonal_questrelation`;

CREATE TABLE `game_event_seasonal_questrelation` (
  `questId` mediumint(8) unsigned NOT NULL COMMENT 'Quest Identifier',
  `eventEntry` int(11) unsigned NOT NULL DEFAULT 0 COMMENT 'Entry of the game event',
  PRIMARY KEY (`questId`,`eventEntry`),
  KEY `idx_quest` (`questId`),
  CONSTRAINT `event_fk` FOREIGN KEY (`eventEntry`) REFERENCES `game_event`(`entry`) ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT `quest_fk` FOREIGN KEY (`questId`) REFERENCES `quest_template`(`entry`) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Player System';

INSERT INTO `game_event_seasonal_questrelation`(`questId`,`eventEntry`) VALUES 
(171,10),
(172,10),
(558,10),
(910,10),
(911,10),
(915,10),
(925,10),
(1468,10),
(1479,10),
(1558,10),
(1657,12),
(1658,12),
(1687,10),
(1800,10),
(4822,10),
(5502,10),
(6961,2),
(6962,2),
(6963,2),
(6964,2),
(6983,2),
(6984,2),
(7021,2),
(7022,2),
(7023,2),
(7024,2),
(7025,2),
(7042,2),
(7043,2),
(7045,2),
(7061,2),
(7062,2),
(7063,2),
(8149,11),
(8150,11),
(8311,12),
(8312,12),
(8322,12),
(8353,12),
(8354,12),
(8355,12),
(8356,12),
(8357,12),
(8358,12),
(8359,12),
(8360,12),
(8373,12),
(8409,12),
(8619,7),
(8635,7),
(8636,7),
(8642,7),
(8643,7),
(8644,7),
(8645,7),
(8646,7),
(8647,7),
(8648,7),
(8649,7),
(8650,7),
(8651,7),
(8652,7),
(8653,7),
(8654,7),
(8670,7),
(8671,7),
(8672,7),
(8673,7),
(8674,7),
(8675,7),
(8676,7),
(8677,7),
(8678,7),
(8679,7),
(8680,7),
(8681,7),
(8682,7),
(8683,7),
(8684,7),
(8685,7),
(8686,7),
(8688,7),
(8713,7),
(8714,7),
(8715,7),
(8716,7),
(8717,7),
(8718,7),
(8719,7),
(8720,7),
(8721,7),
(8722,7),
(8723,7),
(8724,7),
(8725,7),
(8726,7),
(8727,7),
(8744,57),
(8746,2),
(8762,2),
(8763,2),
(8767,57),
(8768,57),
(8769,57),
(8788,57),
(8799,2),
(8803,57),
(8827,2),
(8828,2),
(8860,6),
(8861,6),
(8862,7),
(8863,7),
(8864,7),
(8865,7),
(8866,7),
(8867,7),
(8868,7),
(8870,7),
(8871,7),
(8872,7),
(8873,7),
(8874,7),
(8875,7),
(8876,7),
(8877,7),
(8878,7),
(8879,7),
(8880,7),
(8881,7),
(8882,7),
(8883,7),
(8897,8),
(8898,8),
(8899,8),
(8900,8),
(8901,8),
(8902,8),
(8903,8),
(8904,8),
(8979,8),
(8980,8),
(8981,8),
(8982,8),
(8983,8),
(8984,8),
(8993,8),
(9024,8),
(9025,8),
(9026,8),
(9027,8),
(9028,8),
(9319,1),
(9322,1),
(9323,1),
(9324,1),
(9325,1),
(9326,1),
(9330,1),
(9331,1),
(9332,1),
(9339,1),
(9365,1),
(9367,1),
(9368,1),
(9386,1),
(9388,1),
(9389,1),
(10942,10),
(10943,10),
(10945,10),
(10950,10),
(10951,10),
(10952,10),
(10953,10),
(10954,10),
(10956,10),
(10960,10),
(10962,10),
(10963,10),
(10966,10),
(10967,10),
(10968,10),
(11117,26),
(11118,26),
(11120,26),
(11122,26),
(11131,12),
(11135,12),
(11219,12),
(11220,12),
(11242,12),
(11293,26),
(11294,26),
(11318,26),
(11321,26),
(11356,12),
(11357,12),
(11360,12),
(11361,12),
(11392,12),
(11400,26),
(11401,12),
(11403,12),
(11404,12),
(11405,12),
(11407,26),
(11408,26),
(11409,26),
(11412,26),
(11413,26),
(11419,26),
(11431,26),
(11439,12),
(11440,12),
(11441,26),
(11442,26),
(11446,26),
(11447,26),
(11449,12),
(11450,12),
(11454,26),
(11486,26),
(11487,26),
(11528,57),
(11558,8),
(11580,1),
(11581,1),
(11583,1),
(11584,1),
(11657,1),
(11691,1),
(11696,1),
(11731,1),
(11732,1),
(11734,1),
(11735,1),
(11736,1),
(11737,1),
(11738,1),
(11739,1),
(11740,1),
(11741,1),
(11742,1),
(11743,1),
(11744,1),
(11745,1),
(11746,1),
(11747,1),
(11748,1),
(11749,1),
(11750,1),
(11751,1),
(11752,1),
(11753,1),
(11754,1),
(11755,1),
(11756,1),
(11757,1),
(11758,1),
(11759,1),
(11760,1),
(11761,1),
(11762,1),
(11763,1),
(11764,1),
(11765,1),
(11766,1),
(11767,1),
(11768,1),
(11769,1),
(11770,1),
(11771,1),
(11772,1),
(11773,1),
(11774,1),
(11775,1),
(11776,1),
(11777,1),
(11778,1),
(11779,1),
(11780,1),
(11781,1),
(11782,1),
(11783,1),
(11784,1),
(11785,1),
(11786,1),
(11787,1),
(11799,1),
(11800,1),
(11801,1),
(11802,1),
(11803,1),
(11804,1),
(11805,1),
(11806,1),
(11807,1),
(11808,1),
(11809,1),
(11810,1),
(11811,1),
(11812,1),
(11813,1),
(11814,1),
(11815,1),
(11816,1),
(11817,1),
(11818,1),
(11819,1),
(11820,1),
(11821,1),
(11822,1),
(11823,1),
(11824,1),
(11825,1),
(11826,1),
(11827,1),
(11828,1),
(11829,1),
(11830,1),
(11831,1),
(11832,1),
(11833,1),
(11834,1),
(11835,1),
(11836,1),
(11837,1),
(11838,1),
(11839,1),
(11840,1),
(11841,1),
(11842,1),
(11843,1),
(11844,1),
(11845,1),
(11846,1),
(11847,1),
(11848,1),
(11849,1),
(11850,1),
(11851,1),
(11852,1),
(11853,1),
(11854,1),
(11855,1),
(11856,1),
(11857,1),
(11858,1),
(11859,1),
(11860,1),
(11861,1),
(11862,1),
(11863,1),
(11882,1),
(11883,1),
(11886,1),
(11891,1),
(11915,1),
(11917,1),
(11921,1),
(11922,1),
(11923,1),
(11924,1),
(11925,1),
(11926,1),
(11933,1),
(11935,1),
(11937,1),
(11947,1),
(11948,1),
(11952,1),
(11953,1),
(11954,1),
(11955,1),
(11964,1),
(11966,1),
(11970,1),
(11971,1),
(11972,1),
(11975,10),
(11976,1),
(12012,1),
(12020,26),
(12022,26),
(12062,26),
(12191,26),
(12193,26),
(12194,26),
(12318,26),
(12491,26),
(12492,26);